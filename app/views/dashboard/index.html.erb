<h1>Welcome to Your Dashboard, <%= current_user.first_name %>!</h1>
<hr>

<% if @family %>
  <h2>Your Family: <%= @family.name %></h2>

  <% if @members.any? %>
    <h3>Family Members:</h3>
    <ul>
      <% @members.each do |member| %>
        <li>
          <%= member.first_name %>
          (<%= member.role.name %>) - Username: <%= member.username %>
          <% if current_user == @family.head && member != current_user %>
            <%= link_to "Remove", 
                        remove_member_family_path(@family, member_id: member.id),
                        method: :delete,
                        data: { confirm: "Are you sure you want to remove #{member.first_name}?" },
                        class: "btn btn-danger btn-sm" %>
          <% end %>
        </li>
      <% end %>
    </ul>
  <% else %>
    <p>No members found in your family.</p>
  <% end %>

  <%= link_to "Add Family Member", family_path(@family), class: "btn btn-primary" %>
<% else %>
  <p>You don't have a family yet. <%= link_to "Create One Now", new_family_path, class: "btn btn-success" %>.</p>
<% end %>

<hr>

<h3>Your Family's Tasks:</h3>
<%= link_to "Create a New Task", new_task_path, class: "btn btn-primary" %>
<ul>
  <% if @tasks.any? %>
    <% @tasks.each do |task| %>
      <li>
        <strong><%= task.title %></strong>
        - Assigned to: <%= task.user.first_name %> (Status: <%= task.status.capitalize %>)
        <%= link_to "Delete", task_path(task), 
                    method: :delete, 
                    data: { confirm: "Are you sure you want to delete this task?" }, 
                    class: "btn btn-danger btn-sm" %>
      </li>
    <% end %>
  <% else %>
    <p>No tasks created yet.</p>
  <% end %>
</ul>

<hr>

<h3>Your Appointments:</h3>
<%= link_to "Create Appointment", new_appointment_path, class: "btn btn-primary" %>
<ul>
  <% if @appointments.any? %>
    <% @appointments.each do |appointment| %>
      <li>
        <strong><%= link_to appointment.title, appointment_path(appointment) %></strong>
        - Scheduled: <%= appointment.start_time.strftime("%A, %B %d at %I:%M %p") %>
        <%= link_to "Delete", appointment_path(appointment), 
            method: :delete, 
            data: { turbo_confirm: "Are you sure?" }, 
            class: "btn btn-danger btn-sm" %>
      </li>
    <% end %>
  <% else %>
    <p>No appointments scheduled yet.</p>
  <% end %>
</ul>
